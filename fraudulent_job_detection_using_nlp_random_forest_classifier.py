# -*- coding: utf-8 -*-
"""Fraudulent Job Detection using NLP - Random Forest Classifier.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1_TJdg8758a2A0EQ9Y_vlvB1llFldWJ8o
"""

pip install wordcloud

!pip install -U spacy

import re
import string
import numpy as np
import pandas as pd
import random
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer
from sklearn.model_selection import train_test_split
from sklearn.pipeline import Pipeline
from sklearn.base import TransformerMixin
from sklearn.metrics import accuracy_score, plot_confusion_matrix, classification_report, confusion_matrix
from wordcloud import WordCloud
import spacy
from spacy.lang.en.stop_words import STOP_WORDS
from spacy.lang.en import English

from google.colab import drive
drive.mount('/content/drive')

df = pd.read_csv('/content/drive/MyDrive/Sem 6/Mini Project/Material Project/fake_job_postings.csv')

df.head()

df.shape

# c1 = 16884
# c2 = 756
# for ind in df.index:
#   if df['fraudulent'][ind] == 0:
#     df = df.drop(index = ind)
#     if(c1 > 0):
#       c1 -= 1
#     else:
#       break

# for ind in df.index:
#   if df['fraudulent'][ind] == 1:
#     df = df.drop(index = ind)
#     if(c2 > 0):
#       c2 -= 1
#     else:
#       break

columns = ['job_id', 'telecommuting', 'has_company_logo', 'has_questions', 'salary_range', 'employment_type']
for colu in columns:
  del df[colu]

df.isnull().sum()

df.head()

df.fillna('', inplace=True)

plt.figure(figsize=(15,5))
sns.countplot(y='fraudulent', data=df)
plt.show()

#displays the count of real and fake jobs in fradulent column
df.groupby('fraudulent')['fraudulent'].count()

dff1 = df

exp = dict(df.required_experience.value_counts())
del exp['']

exp

plt.figure(figsize=(10, 5))
sns.set_theme(style="whitegrid")
plt.bar(exp.keys(), exp.values())
plt.title('No of Jobs with Experience', size = 20)
plt.xlabel('Experience', size = 10)
plt.ylabel('No of jobs', size = 10)
plt.xticks(rotation = 30)
plt.show()

def split(location):
  l = location.split(',')
  return l[0]
df['country'] = df.location.apply(split)

country = dict(df.country.value_counts()[:14])
del country['']
country

plt.figure(figsize=(8, 6))
plt.title('Country-wise Job Posting', size = 20)
plt.bar(countr.keys(), countr.values())
plt.xlabel('Countries', size = 10)
plt.ylabel('No of jobs', size = 10)

edu = dict(df.required_education.value_counts()[:7])
del edu['']
edu

plt.figure(figsize=(15, 6))
plt.title('Job Posting Based on Education', size = 20)
plt.bar(edu.keys(), edu.values())
plt.xlabel('Education', size = 10)
plt.ylabel('No of jobs', size = 10)

print(df[df.fraudulent == 0].title.value_counts()[:10])

print(df[df.fraudulent == 1].title.value_counts()[:10])

df['text']=df['title'] + ' ' + df['company_profile'] + ' ' + df['description'] + ' ' + df['requirements'] + ' ' + df['benefits']
del df['title']
del df['location']
del df['department']
del df['company_profile']
del df['description']
del df['requirements']
del df['benefits']
del df['required_experience']
del df['required_education']
del df['industry']
del df['function']
del df['country']

df.head()

# dff1 = df

fraudjobs_text = df[df.fraudulent == 1].text
realjobs_text = df[df.fraudulent == 0].text

STOPWORDS = spacy.lang.en.stop_words.STOP_WORDS
plt.figure(figsize = (16,14))
wc = WordCloud(min_font_size = 3, max_words = 3000, width = 1600, height = 800, stopwords = STOPWORDS).generate(str(" ".join(fraudjobs_text)))
plt.imshow(wc, interpolation = 'bilinear')

STOPWORDS = spacy.lang.en.stop_words.STOP_WORDS
plt.figure(figsize = (16,14))
wc = WordCloud(min_font_size = 3, max_words = 3000, width = 1600, height = 800, stopwords = STOPWORDS).generate(str(" ".join(realjobs_text)))
plt.imshow(wc, interpolation = 'bilinear')

"""................................................................................"""

!pip install spacy && python -m spacy download en

# punctuation = string.punctuation

# nlp = spacy.load("en_core_web_sm")
# stop_words = spacy.lang.en.stop_words.STOP_WORDS

# parser = English()

# def spacy_tokenizer(sentence):

#   punctuation = string.punctuation

#   nlp = spacy.load("en_core_web_sm")
#   stop_words = spacy.lang.en.stop_words.STOP_WORDS

#   parser = English()
#   mytokens = parser(sentence)
#   # mytokens = [word.lemma_.lower().strip() if word.lemma_ != "-PRON-" else word.lower_ for word in mytokens]
#   mytokens = [word for word in mytokens if word not in stop_words and word not in punctuation]
#   return mytokens

# class predictors(TransformerMixin):
#   def tranform(self, X, **transform_params):
#     return [clean_text(text) for text in X]

#   def fit(self, X, y=None, **fit_params):
#     return self

#   def get_params(self, deep = True):
#     return {}

def clean_text(text):
  return text.strip().lower()

from nltk.corpus import stopwords
import nltk
nltk.download('punkt')
nltk.download('stopwords')
from nltk.tokenize import word_tokenize

def spacy_tokenizer(text):
  print(1)
  text_tokens = word_tokenize(text)
  tokens_without_sw = [word for word in text_tokens if not word in stopwords.words()]
  filtered_sentence = (" ").join(tokens_without_sw)
  return filtered_sentence

df['text'] = df['text'].apply(clean_text)

# dff2 = df

df['text'] = df['text'].apply(spacy_tokenizer)

# dff3 = df

# for ind in df.index:
#   if df['fraudulent'][ind] == 1:
#     print(df['text'][ind])
#     print()

cv = TfidfVectorizer(max_features = 100)
x = cv.fit_transform(df['text'])
df1 = pd.DataFrame(x.toarray(), columns = cv.get_feature_names())

# df1

df.drop(["text"], axis = 1, inplace = True)

# df

main_df = pd.concat([df1, df], axis = 1)

# l2 = []
# for ind in df.index:
#   l2.append(df['fraudulent'][ind])
# main_df = df1.assign(fraudulent = l2)

# dff4 = main_df

Y = main_df.iloc[:,-1]
X = main_df.iloc[:,:-1]

X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size = 0.2)

print(X_train.shape)
print(y_train.shape)
print(X_test.shape)
print(y_test.shape)

X_test

from sklearn.ensemble import RandomForestClassifier
rfc = RandomForestClassifier(n_jobs = 3, oob_score = True, n_estimators = 100, criterion = "entropy")
model = rfc.fit(X_train, y_train)

pred = rfc.predict(X_test)
score = accuracy_score(y_test, pred)
score

print("Classification Report\n")
print(classification_report(y_test, pred))
print("Confusion Matrix\n")
print(confusion_matrix(y_test, pred))

"""
Oversampling"""

Y = main_df.iloc[:,-1]
X = main_df.iloc[:,:-1]

df_train, df_test = train_test_split(main_df, test_size = 0.2)

df_train.groupby('fraudulent')['fraudulent'].count()

df_test.groupby('fraudulent')['fraudulent'].count()

from sklearn.utils import resample

df_majority = df_train[(df_train['fraudulent']==0)]
df_minority = df_train[(df_train['fraudulent']==1)]

df_minority_upsampled = resample(df_minority,
                                 replace=True,
                                 n_samples= 13601,
                                 random_state=42)

df_upsampled = pd.concat([df_minority_upsampled, df_majority])

df_upsampled.groupby('fraudulent')['fraudulent'].count()

Y = df_upsampled.iloc[:,-1]
X = df_upsampled.iloc[:,:-1]

X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size = 0.2)

print(X_train.shape)
print(y_train.shape)
print(X_test.shape)
print(y_test.shape)

from sklearn.ensemble import RandomForestClassifier
rfc = RandomForestClassifier(n_jobs = 3, oob_score = True, n_estimators = 100, criterion = "entropy")
model = rfc.fit(X_train, y_train)

pred = rfc.predict(X_test)
score = accuracy_score(y_test, pred)
score

print("Classification Report\n")
print(classification_report(y_test, pred))
+print("Confusion Matrix\n")
print(confusion_matrix(y_test, pred))

"""................................................................................"""

# txt = "marketing intern we're food52, and we've created a groundbreaking and award-winning cooking site. we support, connect, and celebrate home cooks, and give them everything they need in one place.we have a top editorial, business, and engineering team. we're focused on using technology to find new and better ways to connect people around their specific food interests, and to offer them superb, highly curated information about food and cooking. we attract the most talented home cooks and contributors in the country; we also publish well-known professionals like mario batali, gwyneth paltrow, and danny meyer. and we have partnerships with whole foods market and random house.food52 has been named the best food website by the james beard foundation and iacp, and has been featured in the new york times, npr, pando daily, techcrunch, and on the today show.we're located in chelsea, in new york city. food52, a fast-growing, james beard award-winning online food community and crowd-sourced and curated recipe hub, is currently interviewing full- and part-time unpaid interns to work in a small team of editors, executives, and developers in its new york city headquarters.reproducing and/or repackaging existing food52 content for a number of partner sites, such as huffington post, yahoo, buzzfeed, and more in their various content management systemsresearching blogs and websites for the provisions by food52 affiliate programassisting in day-to-day affiliate program support, such as screening affiliates and assisting in any affiliate inquiriessupporting with pr &amp; events when neededhelping with office administrative work, such as filing, mailing, and preparing for meetingsworking with developers to document bugs and suggest improvements to the sitesupporting the marketing and executive staff experience with content management systems a major plus (any blogging counts!)familiar with the food52 editorial voice and aestheticloves food, appreciates the importance of home cooking and cooking with the seasonsmeticulous editor, perfectionist, obsessive attention to detail, maddened by typos and broken links, delighted by finding and fixing themcheerful under pressureexcellent communication skillsa+ multi-tasker and juggler of responsibilities big and smallinterested in and engaged with social media like twitter, facebook, and pinterestloves problem-solving and collaborating to drive food52 forwardthinks big picture but pitches in on the nitty gritty of running a small company (dishes, shopping, administrative support)comfortable with the realities of working for a startup: being on call on evenings and weekends, and working long hours"

txt = "Facilities Development Engineer Aker Solutions is a global provider of products, systems and services to the oil and gas industry. Our engineering, design and technology bring discoveries into production and maximize recovery from each petroleum field. We employ approximately 28,000 people in about 30 countries. Go to #URL_0fa3f7c5e23a16de16a841e368006cae916884407d90b154dfef3976483a71ae# for more information on our business, people and values. Corporate overviewAker Solutions is a global provider of products, systems and services to the oil and gas industry. Our engineering, design and technology bring discoveries into production and maximize recovery from each petroleum field. We employ approximately 28,000 people in about 30 countries. Go to #URL_0fa3f7c5e23a16de16a841e368006cae916884407d90b154dfef3976483a71ae# for more information on our business, people and values.Aker Solutions' Concept and Technology team based in St. John's, Newfoundland provides all front-end engineering services required for the development of oil and gas exploration and production facilities, with a strategic focus on field developments in varying water depth and harsh environments. Aker Solutions delivers complete field development solutions and undertakes all activities required to provide the facilities needed for oil and gas exploration, production and processing.Our products and services range from feasibility studies and field planning, through concept screening and selection, concept definition and project execution strategy, to detail engineering, procurement and construction management assistance.We need highly skilled engineers who can strengthen our team and support our ambitious growth plans and clients within the region. We are looking for a Facilities Development Engineer.Responsibilities and tasksManage execution of Facilities System and Topsides Front End Engineering scopes including staffing and competence development.Participate in defining strategies and business development to develop new client basis. Ensure that all system solutions in support of new business opportunities meet specified functional design criteria, and all technical and regulatory requirements.Identify and execute Facilities Systems and Topsides Front End Engineering work including opportunity appraisal, feasibility and concept screening studies, Pre-FEED and FEED. Coordinate and collaborate with subject matter experts within Aker Solutions in providing solutions, establishing and carrying out scope of works related to Facilities concepts. Understands project execution and can play a key role in project kick-off as per Aker Solution’s Project Execution Model (PEM). Assist in identifying project Risks, &amp; Opportunities, uncertainties and contribute to identification of mitigation strategies. Qualifications &amp; personal attributesBachelor of Engineering Degree (or higher) With more than 15 years’ experience in Topsides and/or Field Development Feasibility and concept design, of which at least four years at specialist / managerial level. Overall understanding of totality and disciplines relevant for development of topsides as part of field development concepts.Experience with front-end opportunity appraisal, option evaluation, feasibility assessments and concept development selection.Assets: Significant project engineering and offshore installation and construction experience, preferably in harsh &amp; ice prone environmentsProject cost estimating, schedule development, economic screening and evaluation experience.Experience in concept development and field development planning Knowledge of all project development stages. Knowledge and understanding of CNLOPB and Transport Canada Regulation requirements.Key Competencies:Facilities Development Engineer will display the following competencies and complete the below described essential duties.Analyse Issues and Solve Problems - Gathers the most important information; analyses, incorporates, and applies new information and concepts; recognizes symptoms that indicate problems; makes sound and timely decisions.Understand Strategies - Demonstrates understanding and support of the organization’s mission and strategies; integrates and balances big-picture concerns with day-to-day activities. Encourages Commitment - Projects a positive image and serves as a role model for others; promotes commitment to the organization’s vision, values, and direction; acknowledges others’ efforts and accomplishments.Communicate Effectively - Expresses ideas clearly and concisely; listens carefully and attentively to others’ opinions and ideas; shares information and viewpoints openly and directly with others.Execute Efficiently - Delegates responsibility and conveys clear expectations to the appropriate staff; monitors the progress of others and redirects efforts and/or removes obstacles in order to get efforts back on track; deals with high-priority work activities first.Show Initiative - Sets high standards of performance for self and others and maintains a consistent, high level of productivity; takes personal responsibility to make decisions and take action; does not easily give up in the face of obstacles.Seek Customer Satisfaction - Seeks feedback from customers; tracks performance against customer requirements; addresses customer needs by involving the right people at the right time and follows up to ensure problems are solved.We offer• Friendly colleagues in an industry with a bright future.• An environment where you are encouraged to develop your skills and share your knowledge with your colleagues.• Competitive benefits and strong focus on work-life balance.Consistent with the Accords Act, residents of Newfoundland and Labrador specifically, and Canadians in generally, who are qualified, will be given first consideration for training and employment."

# txt = "Customer service/ Data Entry Customer Service SpecialistWe are currently looking for talented and creative individuals to continue growing the company. If you're looking to work in an organization where you can make a long-term home, and flex both your technical and creative skills, this may be the role for you! We pride ourselves on a work hard/play hard mentality and friendly, team-based culture.We're searching for a full-time Customer Support Specialist with strong customer service background, excellent communication skills and outgoing personality.Primary ResponsibilitiesRespond to incoming calls and e-mail / mail requestsContact current customersVerify payment requests over the telephoneDuring low volume intervals perform customer follow-ups, research escalated issues, and complete special projects Skills/RequirementsSome customer support experience preferred, but will train the right candidateMinimum high school diploma or equivalentAbility to multi-taskPositive attitude and friendly telephone demeanorProfessional written and communication skillsBasic knowledge of computers Benefits &amp; CompensationExcellent health insurance including medical, dental and vision401K with matching planPaid holidays, vacation and sick daysCompensation:Hourly., DOE"

# txt = "Process Engineer JOB DESCRIPTION: PROCESS ENGINEER Process EngineerProvide process engineering support to unit operations. Troubleshoot and optimize refinery process units. Develop engineering solutions to complex operating problems. Assist with process control projects.Lead the PSM implementation for refinery projects. This will include P&amp;ID reviews, PHA's, MOC’s, and PSSR's.Apply good safety and environmental practices in all process recommendationsIn our smaller, independent refinery, our process engineers must be multi-faceted in order to develop refinery capital investment projects providing economic justification for each project. Develop the process design packages for their implementation. Prepare specifications, drawings, bid packages, quotation analysis and other applicable documents for purchase, construction, and repair of refinery facilities. Supervise the activities of contract engineering and construction personnel. B.S. in Chemical Engineering required with 3 to 10 years experience in Refining or Petrochemical sectors.   Excellent wage/benefit package available."

txt = clean_text(txt)
# txt1 = clean_text(txt1)


list = [txt]
inp = pd.DataFrame()
inp["text"] = list

inp

cv = TfidfVectorizer(max_features = 20)
x1 = cv.fit_transform(inp['text'])
inp1 = pd.DataFrame(x1.toarray(), columns = cv.get_feature_names())
# inp.drop(["text"], axis = 1, inplace = True)
# main_inp = pd.concat([inp1, inp], axis = 1)

# main_inp
inp1

inp_pred = rfc.predict(inp1)

inp_pred[0]

# import pickle
# filename = 'model_2.pkl'
# pickle.dump(rfc, open(filename, 'wb'))

# Customer Service - Cloud Video Production
# 90 Seconds, the worlds Cloud Video Production Service.90 Seconds is the worlds Cloud Video Production Service enabling brands and agencies to get high quality online video content shot and produced anywhere in the world. 90 Seconds makes video production fast, affordable, and all managed seamlessly in the cloud from purchase to publish. Seconds removes the hassle, cost, risk and speed issues of working with regular video production companies by managing every aspect of video projects in a beautiful online experience. With a growing global network of over 2,000 rated video professionals in over 50 countries managed by dedicated production success teams in 5 countries, 90 Seconds provides a 100% success guarantee.90 Seconds has produced almost 4,000 videos in over 30 Countries for over 500 Global brands including some of the worlds largest including Paypal, L’Oreal, Sony and Barclays and has offices in Auckland, London, Sydney, Tokyo and Singapore.
# Organised - Focused - Vibrant - Awesome!Do you have a passion for customer service? Slick typing skills? Maybe Account Management? ...And think administration is cooler than a polar bear on a jetski? Then we need to hear you! We are the Cloud Video Production Service and opperating on a glodal level. Yeah, it's pretty cool. Serious about delivering a world class product and excellent customer service.Our rapidly expanding business is looking for a talented Project Manager to manage the successful delivery of video projects, manage client communications and drive the production process. Work with some of the coolest brands on the planet and learn from a global team that are representing NZ is a huge way!We are entering the next growth stage of our business and growing quickly internationally.  Therefore, the position is bursting with opportunity for the right person entering the business at the right time. 90 Seconds, the worlds Cloud Video Production Service. Seconds is the worlds Cloud Video Production Service enabling brands and agencies to get high quality online video content shot and produced anywhere in the world. Fast, affordable, and all managed seamlessly in the cloud from purchase to publish. 90 Seconds removes the hassle, cost, risk and speed issues of working with regular video production companies by managing every aspect of video projects in a beautiful online experience.  With a growing network of over 2,000 rated video professionals in over 50 countries and dedicated production success teams in 5 countries guaranteeing video project success 100%. It's as easy as commissioning a quick google adwords campaign.90 Seconds has produced almost 4,000 videos in over 30 Countries for over 500 Global brands including some of the worlds largest including Paypal, L'oreal, Sony and Barclays and has offices in Auckland, London, Sydney, Tokyo &amp; Singapore.Our Auckland office is based right in the heart of the Wynyard Quarter Innovation Precinct - GridAKL!
# What we expect from you:Your key responsibility will be to communicate with the client, 90 Seconds team and freelance community throughout the video production process including, shoot planning, securing freelance talent, managing workflow and the online production management system.  The aim is to manage each video project effectively so that we produce great videos that our clients love.Key attributesClient focused - excellent customer service and communication skillsOnline - oustanding computer knowledge and experience using online software and project management toolsOrganised - manage workload and able to multi-task100% attention to detailMotivated - self-starter with a passion for doing excellent work and achieving great resultsAdaptable - show initiative and think on your feet as this is a constantly evolving atmosphereFlexible - fast turnaround work and after hours availabilityEasy going &amp; upbeat - dosen't get bogged down and loves the challengeSense of Humour - have a laugh and know that working in a startup takes guts!Ability to deliver - including meeting project deadlines and budgetAttitude is more important than experience at 90 Seconds, however previous experience in customer service and/or project management is beneficialPlease view our platform / website at #URL_395a8683a907ce95f49a12fb240e6e47ad8d5a4f96d07ebbd869c4dd4dea1826# and get a clear understand about what we do before reaching out.
# What you will get from usThrough being part of the 90 Seconds team you will gain:experience working on projects located around the world with an international brandexperience working with a variety of clients and on a large range of projectsopportunity to drive and grow production function and teama positive working environment with a great teamPay$40,000-$55,000Applying for this role with a VIDEOBeing a video business, we understand that one of the quickest ways that we can assess your suitability for this role, and one of the quickest ways that you can apply for it, is for you to submit a 60-90 second long video telling us about yourself, your experience and why you think you would be perfect for the role.  It’s not about being a filmmaker or making a really creative video.  A simple video filmed with a smart phone or web cam will be fine. Please also include where you are based and when you can start.You can upload the video onto YouTube or Vimeo (or similar) as a Draft or Live link.APPLICATIONS DUE by 5pm on Wednesday 18th July 2014 - Once you have a video ready, apply for this role via the following link together with a cover letter and your CV. After we have watched your video and get an idea of your suitability for the role, we will email the shortlisted candidates

# import pickle

# with open('model_2.pkl' , 'rb') as f:
#     rfc = pickle.load(f)

